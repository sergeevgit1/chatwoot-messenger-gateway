# üìö –†—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ Chatwoot API: –°–æ–∑–¥–∞–Ω–∏–µ –∏ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞–º–∏

–≠—Ç–æ –ø–æ–¥—Ä–æ–±–Ω–æ–µ —Ä—É–∫–æ–≤–æ–¥—Å—Ç–≤–æ –ø–æ —Ä–∞–±–æ—Ç–µ —Å Chatwoot API –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–æ–≤, —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏, —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏.

## üìã –°–æ–¥–µ—Ä–∂–∞–Ω–∏–µ

1. [–û–±–∑–æ—Ä Chatwoot API](#–æ–±–∑–æ—Ä-chatwoot-api)
2. [–ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è](#–∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è)
3. [–≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API](#—ç–Ω–¥–ø–æ–∏–Ω—Ç—ã-api)
4. [–°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–±–æ–∫—Å–æ–≤](#—Å–æ–∑–¥–∞–Ω–∏–µ-–∏–Ω–±–æ–∫—Å–æ–≤)
5. [–†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏](#—Ä–∞–±–æ—Ç–∞-—Å-–∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏)
6. [–£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏](#—É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ-—Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏)
7. [–û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π](#–æ—Ç–ø—Ä–∞–≤–∫–∞-—Å–æ–æ–±—â–µ–Ω–∏–π)
8. [–ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤](#–Ω–∞—Å—Ç—Ä–æ–π–∫–∞-–≤–µ–±—Ö—É–∫–æ–≤)
9. [–¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è](#—Ç–∏–ø–∏—á–Ω—ã–µ-–æ—à–∏–±–∫–∏-–∏-—Ä–µ—à–µ–Ω–∏—è)
10. [–ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ JavaScript](#–ø—Ä–∏–º–µ—Ä—ã-—Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏-–Ω–∞-javascript)

---

## üîë –û–±–∑–æ—Ä Chatwoot API

Chatwoot API –ø—Ä–µ–¥–æ—Å—Ç–∞–≤–ª—è–µ—Ç RESTful –∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å –¥–ª—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–∏ —Å –ø–ª–∞—Ç—Ñ–æ—Ä–º–æ–π Chatwoot. API –ø–æ–∑–≤–æ–ª—è–µ—Ç —É–ø—Ä–∞–≤–ª—è—Ç—å –∏–Ω–±–æ–∫—Å–∞–º–∏, –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏, —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏ –∏ —Å–æ–æ–±—â–µ–Ω–∏—è–º–∏ –ø—Ä–æ–≥—Ä–∞–º–º–Ω—ã–º —Å–ø–æ—Å–æ–±–æ–º.

### –ë–∞–∑–æ–≤—ã–π URL

```
https://your-chatwoot.com/api/v1/accounts/{ACCOUNT_ID}
```

–ì–¥–µ:
- `your-chatwoot.com` - –≤–∞—à –¥–æ–º–µ–Ω Chatwoot
- `ACCOUNT_ID` - ID –≤–∞—à–µ–≥–æ –∞–∫–∫–∞—É–Ω—Ç–∞ –≤ Chatwoot

---

## üîê –ê—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏—è

Chatwoot API –∏—Å–ø–æ–ª—å–∑—É–µ—Ç –¥–≤–∞ –º–µ—Ç–æ–¥–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏:

### 1. –ß–µ—Ä–µ–∑ API Access Token

```javascript
const headers = {
  'Content-Type': 'application/json',
  'api_access_token': 'YOUR_API_ACCESS_TOKEN'
};
```

### 2. –ß–µ—Ä–µ–∑ Bearer Token

```javascript
const headers = {
  'Content-Type': 'application/json',
  'Authorization': 'Bearer YOUR_API_ACCESS_TOKEN'
};
```

> üí° **–†–µ–∫–æ–º–µ–Ω–¥–∞—Ü–∏—è**: –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –¥–ª—è –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–π —Å–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç–∏

---

## üõ†Ô∏è –≠–Ω–¥–ø–æ–∏–Ω—Ç—ã API

### –ò–Ω–±–æ–∫—Å—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `GET` | `/inboxes` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω–±–æ–∫—Å–æ–≤ |
| `POST` | `/inboxes` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∏–Ω–±–æ–∫—Å–∞ |
| `GET` | `/inboxes/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ–± –∏–Ω–±–æ–∫—Å–µ |
| `PUT` | `/inboxes/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞ |
| `DELETE` | `/inboxes/{id}` | –£–¥–∞–ª–µ–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞ |

### –ö–æ–Ω—Ç–∞–∫—Ç—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `GET` | `/contacts` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ |
| `POST` | `/contacts` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞ |
| `GET` | `/contacts/search` | –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ |
| `POST` | `/contacts/filter` | –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ |
| `GET` | `/contacts/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ –∫–æ–Ω—Ç–∞–∫—Ç–µ |
| `PATCH` | `/contacts/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞ |

### –†–∞–∑–≥–æ–≤–æ—Ä—ã

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `GET` | `/conversations` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ |
| `POST` | `/conversations` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ |
| `GET` | `/conversations/{id}` | –ü–æ–ª—É—á–µ–Ω–∏–µ –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–∏ –æ —Ä–∞–∑–≥–æ–≤–æ—Ä–µ |
| `PATCH` | `/conversations/{id}` | –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ |

### –°–æ–æ–±—â–µ–Ω–∏—è

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `GET` | `/conversations/{id}/messages` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–æ–æ–±—â–µ–Ω–∏–π —Ä–∞–∑–≥–æ–≤–æ—Ä–∞ |
| `POST` | `/conversations/{id}/messages` | –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è |

### –í–µ–±—Ö—É–∫–∏

| –ú–µ—Ç–æ–¥ | –≠–Ω–¥–ø–æ–∏–Ω—Ç | –û–ø–∏—Å–∞–Ω–∏–µ |
|------|----------|----------|
| `GET` | `/webhooks` | –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤ |
| `POST` | `/webhooks` | –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –≤–µ–±—Ö—É–∫–∞ |
| `DELETE` | `/webhooks/{id}` | –£–¥–∞–ª–µ–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞ |

---

## üìÆ –°–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–±–æ–∫—Å–æ–≤

### –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–∞

```javascript
const inboxData = {
  name: "VK Connector",           // –ù–∞–∑–≤–∞–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞
  channel_type: "Channel::Api",   // –¢–∏–ø –∫–∞–Ω–∞–ª–∞
  medium: "vk",                   // –ò–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä –ø–ª–∞—Ç—Ñ–æ—Ä–º—ã
  webhook_url: ""                 // URL –≤–µ–±—Ö—É–∫–∞ (–º–æ–∂–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –ø–æ–∑–∂–µ)
};
```

### –ü—Ä–∏–º–µ—Ä –∑–∞–ø—Ä–æ—Å–∞ –Ω–∞ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞

```javascript
const createInbox = async () => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/inboxes`;
  
  const inboxData = {
    name: "VK Connector",
    channel_type: "Channel::Api",
    medium: "vk",
    webhook_url: ""
  };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: {
        'Content-Type': 'application/json',
        'api_access_token': apiToken,
        'Authorization': `Bearer ${apiToken}`
      },
      body: JSON.stringify(inboxData)
    });
    
    if (!response.ok) {
      const errorText = await response.text();
      throw new Error(`HTTP ${response.status}: ${errorText}`);
    }
    
    const data = await response.json();
    return data.payload || data;
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–∞:', error.message);
    throw error;
  }
};
```

### –ü—Ä–∏–º–µ—Ä –æ—Ç–≤–µ—Ç–∞ –ø—Ä–∏ —É—Å–ø–µ—à–Ω–æ–º —Å–æ–∑–¥–∞–Ω–∏–∏

```json
{
  "id": 12345,
  "name": "VK Connector",
  "channel_type": "Channel::Api",
  "medium": "vk",
  "webhook_url": "",
  "account_id": 1,
  "enabled": true,
  "created_at": "2023-12-01T10:00:00Z",
  "updated_at": "2023-12-01T10:00:00Z"
}
```

---

## üë• –†–∞–±–æ—Ç–∞ —Å –∫–æ–Ω—Ç–∞–∫—Ç–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞

```javascript
const createContact = async (inboxId, contactData) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/contacts`;
  
  const payload = {
    inbox_id: inboxId,
    name: contactData.name,
    phone_number: contactData.phone,
    email: contactData.email,
    identifier: contactData.identifier,
    custom_attributes: contactData.customAttributes || {},
    additional_attributes: contactData.additionalAttributes || {}
  };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: headers,
      body: JSON.stringify(payload)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞:', error.message);
    throw error;
  }
};
```

### –ü–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤

```javascript
const searchContacts = async (query) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/contacts/search`;
  const params = new URLSearchParams({ q: query });
  
  try {
    const response = await fetch(`${url}?${params}`, {
      method: 'GET',
      headers: headers
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–∏—Å–∫–∞ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤:', error.message);
    throw error;
  }
};
```

### –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –ø–æ –∞—Ç—Ä–∏–±—É—Ç–∞–º

```javascript
const filterContacts = async (attributes) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/contacts/filter`;
  
  const filters = Object.entries(attributes).map(([key, value]) => ({
    attribute_key: key,
    filter_operator: 'equal_to',
    values: [String(value)]
  }));
  
  const payload = { payload: filters };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: headers,
      body: JSON.stringify(payload)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–∏ –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤:', error.message);
    throw error;
  }
};
```

---

## üí¨ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞–º–∏

### –°–æ–∑–¥–∞–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞

```javascript
const createConversation = async (inboxId, sourceId, contactId = null) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/conversations`;
  
  const payload = {
    inbox_id: inboxId,
    source_id: sourceId,
    contact_id: contactId,
    custom_attributes: {}
  };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: headers,
      body: JSON.stringify(payload)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–∞:', error.message);
    throw error;
  }
};
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤ –∫–æ–Ω—Ç–∞–∫—Ç–∞

```javascript
const getContactConversations = async (contactId) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/contacts/${contactId}/conversations`;
  
  try {
    const response = await fetch(url, {
      method: 'GET',
      headers: headers
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è —Ä–∞–∑–≥–æ–≤–æ—Ä–æ–≤:', error.message);
    throw error;
  }
};
```

---

## üì® –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏–π

### –û—Ç–ø—Ä–∞–≤–∫–∞ —Å–æ–æ–±—â–µ–Ω–∏—è –≤ —Ä–∞–∑–≥–æ–≤–æ—Ä

```javascript
const sendMessage = async (conversationId, content, messageType = 'outgoing') => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/conversations/${conversationId}/messages`;
  
  const payload = {
    content: content,
    message_type: messageType  // 'incoming' –∏–ª–∏ 'outgoing'
  };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: headers,
      body: JSON.stringify(payload)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è:', error.message);
    throw error;
  }
};
```

---

## üîó –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –≤–µ–±—Ö—É–∫–æ–≤

### –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞

```javascript
const createWebhook = async (webhookUrl) => {
  const url = `${baseUrl}/api/v1/accounts/${accountId}/webhooks`;
  
  const webhookData = {
    webhook_url: webhookUrl,
    subscriptions: [
      'message_created',
      'conversation_status_changed',
      'contact_created'
    ]
  };
  
  try {
    const response = await fetch(url, {
      method: 'POST',
      headers: headers,
      body: JSON.stringify(webhookData)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  } catch (error) {
    console.error('–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±—Ö—É–∫–∞:', error.message);
    throw error;
  }
};
```

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–æ–±—ã—Ç–∏—è –¥–ª—è –ø–æ–¥–ø–∏—Å–∫–∏

- `message_created` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è
- `conversation_created` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- `conversation_status_changed` - –ò–∑–º–µ–Ω–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Ä–∞–∑–≥–æ–≤–æ—Ä–∞
- `contact_created` - –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞
- `contact_updated` - –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∫–æ–Ω—Ç–∞–∫—Ç–∞

---

## ‚ö†Ô∏è –¢–∏–ø–∏—á–Ω—ã–µ –æ—à–∏–±–∫–∏ –∏ —Ä–µ—à–µ–Ω–∏—è

### 1. –û—à–∏–±–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏ (401)

**–ü—Ä–æ–±–ª–µ–º–∞**: `HTTP 401: Unauthorized`

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å API —Ç–æ–∫–µ–Ω–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–∞ –∑–∞–≥–æ–ª–æ–≤–∫–∞ –∞—É—Ç–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ü–∏–∏

```javascript
const headers = {
  'Content-Type': 'application/json',
  'api_access_token': apiToken,
  'Authorization': `Bearer ${apiToken}`
};
```

### 2. –û—à–∏–±–∫–∞ –¥–æ—Å—Ç—É–ø–∞ (403)

**–ü—Ä–æ–±–ª–µ–º–∞**: `HTTP 403: Forbidden`

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∞ –¥–æ—Å—Ç—É–ø–∞ API —Ç–æ–∫–µ–Ω–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Ç–æ–∫–µ–Ω –∏–º–µ–µ—Ç –ø—Ä–∞–≤–∞ –Ω–∞ —É–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∏–Ω–±–æ–∫—Å–∞–º–∏
- –û–±—Ä–∞—Ç–∏—Ç–µ—Å—å –∫ –∞–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—É Chatwoot –¥–ª—è –ø–æ–ª—É—á–µ–Ω–∏—è –Ω–µ–æ–±—Ö–æ–¥–∏–º—ã—Ö –ø—Ä–∞–≤

### 3. –û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–∞ (422)

**–ü—Ä–æ–±–ª–µ–º–∞**: `HTTP 422: Unprocessable Entity`

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å—Ç—Ä—É–∫—Ç—É—Ä—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–∞
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ –≤—Å–µ –æ–±—è–∑–∞—Ç–µ–ª—å–Ω—ã–µ –ø–æ–ª—è –∑–∞–ø–æ–ª–Ω–µ–Ω—ã
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å –∑–Ω–∞—á–µ–Ω–∏—è `channel_type`

```javascript
const inboxData = {
  name: "VK Connector",
  channel_type: "Channel::Api",  // –ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –∑–Ω–∞—á–µ–Ω–∏–µ
  medium: "vk",
  webhook_url: ""
};
```

### 4. –í–Ω—É—Ç—Ä–µ–Ω–Ω—è—è –æ—à–∏–±–∫–∞ —Å–µ—Ä–≤–µ—Ä–∞ (500)

**–ü—Ä–æ–±–ª–µ–º–∞**: `HTTP 500: Internal Server Error`

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –≤–µ—Ä—Å–∏—é Chatwoot - –≤–æ–∑–º–æ–∂–Ω–æ —Ñ–æ—Ä–º–∞—Ç API –∏–∑–º–µ–Ω–∏–ª—Å—è
- –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å–æ–∑–¥–∞—Ç—å –∏–Ω–±–æ–∫—Å –≤—Ä—É—á–Ω—É—é —á–µ—Ä–µ–∑ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ª–æ–≥–∏ —Å–µ—Ä–≤–µ—Ä–∞ Chatwoot –¥–ª—è –¥–µ—Ç–∞–ª—å–Ω–æ–π –¥–∏–∞–≥–Ω–æ—Å—Ç–∏–∫–∏

### 5. –û—à–∏–±–∫–∞ —Å–µ—Ç–∏

**–ü—Ä–æ–±–ª–µ–º–∞**: `ENOTFOUND`, `ECONNREFUSED`, `ETIMEDOUT`

**–†–µ—à–µ–Ω–∏–µ**:
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ—Å—Ç—å URL Chatwoot
- –£–±–µ–¥–∏—Ç–µ—Å—å, —á—Ç–æ —Å–µ—Ä–≤–µ—Ä Chatwoot –¥–æ—Å—Ç—É–ø–µ–Ω
- –ü—Ä–æ–≤–µ—Ä—å—Ç–µ —Å–µ—Ç–µ–≤–æ–µ —Å–æ–µ–¥–∏–Ω–µ–Ω–∏–µ –∏ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏ —Ñ–∞–π—Ä–≤–æ–ª–∞

---

## üíª –ü—Ä–∏–º–µ—Ä—ã —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏ –Ω–∞ JavaScript

### –ö–ª–∞—Å—Å –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Chatwoot API

```javascript
class ChatwootAPI {
  constructor(baseUrl, apiToken, accountId) {
    this.baseUrl = baseUrl.replace(/\/$/, '');
    this.accountId = accountId;
    this.apiToken = apiToken;
    this.headers = {
      'Content-Type': 'application/json',
      'api_access_token': apiToken,
      'Authorization': `Bearer ${apiToken}`
    };
  }

  // –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
  async testConnection() {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/inboxes`;
    
    try {
      const response = await fetch(url, { headers: this.headers });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      return await response.json();
    } catch (error) {
      throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è: ${error.message}`);
    }
  }

  // –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω–±–æ–∫—Å–æ–≤
  async getInboxes() {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/inboxes`;
    
    try {
      const response = await fetch(url, { headers: this.headers });
      
      if (!response.ok) {
        throw new Error(`HTTP ${response.status}: ${response.statusText}`);
      }
      
      const data = await response.json();
      return data.payload || [];
    } catch (error) {
      throw new Error(`–û—à–∏–±–∫–∞ –ø–æ–ª—É—á–µ–Ω–∏—è –∏–Ω–±–æ–∫—Å–æ–≤: ${error.message}`);
    }
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ VK –∏–Ω–±–æ–∫—Å–∞
  async createVKInbox() {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/inboxes`;
    
    const inboxData = {
      name: 'VK Connector',
      channel_type: 'Channel::Api',
      medium: 'vk',
      webhook_url: ''
    };
    
    try {
      const response = await fetch(url, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify(inboxData)
      });
      
      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`HTTP ${response.status}: ${errorText}`);
      }
      
      const data = await response.json();
      return data.payload || data;
    } catch (error) {
      throw new Error(`–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∏–Ω–±–æ–∫—Å–∞: ${error.message}`);
    }
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞
  async createWebhook(webhookUrl) {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/webhooks`;
    
    const webhookData = {
      webhook_url: webhookUrl,
      subscriptions: ['message_created', 'conversation_status_changed']
    };
    
    try {
      const response = await fetch(url, {
        method: 'POST',
        headers: this.headers,
        body: JSON.stringify(webhookData)
      });
      
      if (!response.ok) {
        const errorText = await response.text();
        throw new Error(`HTTP ${response.status}: ${errorText}`);
      }
      
      const data = await response.json();
      return data.payload || data;
    } catch (error) {
      throw new Error(`–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –≤–µ–±—Ö—É–∫–∞: ${error.message}`);
    }
  }

  // –°–æ–∑–¥–∞–Ω–∏–µ –∏–ª–∏ –ø–æ–∏—Å–∫ –∫–æ–Ω—Ç–∞–∫—Ç–∞
  async ensureContact(inboxId, searchKey, name = null, phone = null, email = null) {
    // –°–Ω–∞—á–∞–ª–∞ –∏—â–µ–º –∫–æ–Ω—Ç–∞–∫—Ç –ø–æ custom_attributes
    try {
      const filterResponse = await this.filterContacts({ vk_user_id: searchKey });
      const contacts = filterResponse.payload || [];
      
      if (contacts.length > 0) {
        return { id: contacts[0].id, source_id: searchKey };
      }
    } catch (error) {
      // –ï—Å–ª–∏ —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è –Ω–µ —É–¥–∞–ª–∞—Å—å, –ø—Ä–æ–¥–æ–ª–∂–∞–µ–º —Å —Å–æ–∑–¥–∞–Ω–∏–µ–º
      console.warn('–§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–æ–≤ –Ω–µ —É–¥–∞–ª–∞—Å—å, —Å–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π:', error.message);
    }
    
    // –°–æ–∑–¥–∞–µ–º –Ω–æ–≤—ã–π –∫–æ–Ω—Ç–∞–∫—Ç
    const contactData = {
      inbox_id: inboxId,
      name: name,
      phone_number: phone,
      email: email,
      identifier: searchKey,
      custom_attributes: { vk_user_id: searchKey }
    };
    
    try {
      const response = await this.createContact(contactData);
      const contact = response.payload || response;
      return { id: contact.id, source_id: searchKey };
    } catch (error) {
      throw new Error(`–û—à–∏–±–∫–∞ —Å–æ–∑–¥–∞–Ω–∏—è –∫–æ–Ω—Ç–∞–∫—Ç–∞: ${error.message}`);
    }
  }

  // –í—Å–ø–æ–º–æ–≥–∞—Ç–µ–ª—å–Ω—ã–µ –º–µ—Ç–æ–¥—ã
  async createContact(contactData) {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/contacts`;
    
    const response = await fetch(url, {
      method: 'POST',
      headers: this.headers,
      body: JSON.stringify(contactData)
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  }

  async filterContacts(attributes) {
    const url = `${this.baseUrl}/api/v1/accounts/${this.accountId}/contacts/filter`;
    
    const filters = Object.entries(attributes).map(([key, value]) => ({
      attribute_key: key,
      filter_operator: 'equal_to',
      values: [String(value)]
    }));
    
    const response = await fetch(url, {
      method: 'POST',
      headers: this.headers,
      body: JSON.stringify({ payload: filters })
    });
    
    if (!response.ok) {
      throw new Error(`HTTP ${response.status}`);
    }
    
    return await response.json();
  }
}
```

### –ü—Ä–∏–º–µ—Ä –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è –∫–ª–∞—Å—Å–∞

```javascript
// –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è API –∫–ª–∏–µ–Ω—Ç–∞
const chatwootAPI = new ChatwootAPI(
  'https://your-chatwoot.com',
  'your_api_token',
  1  // Account ID
);

// –û—Å–Ω–æ–≤–Ω–∞—è —Ñ—É–Ω–∫—Ü–∏—è –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
async function setupVKConnector() {
  try {
    // 1. –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è
    console.log('üîç –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –ø–æ–¥–∫–ª—é—á–µ–Ω–∏—è...');
    await chatwootAPI.testConnection();
    console.log('‚úÖ –ü–æ–¥–∫–ª—é—á–µ–Ω–∏–µ —É—Å–ø–µ—à–Ω–æ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω–æ');
    
    // 2. –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω–±–æ–∫—Å–æ–≤
    console.log('üìã –ü–æ–ª—É—á–µ–Ω–∏–µ —Å–ø–∏—Å–∫–∞ –∏–Ω–±–æ–∫—Å–æ–≤...');
    const inboxes = await chatwootAPI.getInboxes();
    console.log(`‚úÖ –ù–∞–π–¥–µ–Ω–æ –∏–Ω–±–æ–∫—Å–æ–≤: ${inboxes.length}`);
    
    // 3. –ü–æ–∏—Å–∫ —Å—É—â–µ—Å—Ç–≤—É—é—â–µ–≥–æ VK –∏–Ω–±–æ–∫—Å–∞
    let vkInbox = inboxes.find(inbox => 
      inbox.name && inbox.name.toLowerCase().includes('vk')
    );
    
    if (!vkInbox) {
      // 4. –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ VK –∏–Ω–±–æ–∫—Å–∞
      console.log('üîß –°–æ–∑–¥–∞–Ω–∏–µ –Ω–æ–≤–æ–≥–æ VK –∏–Ω–±–æ–∫—Å–∞...');
      vkInbox = await chatwootAPI.createVKInbox();
      console.log(`‚úÖ –ò–Ω–±–æ–∫—Å —Å–æ–∑–¥–∞–Ω —Å ID: ${vkInbox.id}`);
    } else {
      console.log(`‚úÖ –ù–∞–π–¥–µ–Ω —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π VK –∏–Ω–±–æ–∫—Å —Å ID: ${vkInbox.id}`);
    }
    
    // 5. –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞
    const webhookUrl = 'https://your-server.com/chatwoot/webhook/webhook-id';
    console.log('üîó –°–æ–∑–¥–∞–Ω–∏–µ –≤–µ–±—Ö—É–∫–∞...');
    const webhook = await chatwootAPI.createWebhook(webhookUrl);
    console.log(`‚úÖ –í–µ–±—Ö—É–∫ —Å–æ–∑–¥–∞–Ω —Å ID: ${webhook.id}`);
    
    // 6. –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞
    console.log('üë§ –°–æ–∑–¥–∞–Ω–∏–µ —Ç–µ—Å—Ç–æ–≤–æ–≥–æ –∫–æ–Ω—Ç–∞–∫—Ç–∞...');
    const contact = await chatwootAPI.ensureContact(
      vkInbox.id,
      '12345678',  // VK User ID
      'Test User',
      '+1234567890',
      'test@example.com'
    );
    console.log(`‚úÖ –ö–æ–Ω—Ç–∞–∫—Ç —Å–æ–∑–¥–∞–Ω —Å ID: ${contact.id}`);
    
    return {
      inboxId: vkInbox.id,
      webhookId: webhook.id,
      contactId: contact.id
    };
    
  } catch (error) {
    console.error('‚ùå –û—à–∏–±–∫–∞ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏:', error.message);
    throw error;
  }
}

// –ó–∞–ø—É—Å–∫ –Ω–∞—Å—Ç—Ä–æ–π–∫–∏
setupVKConnector()
  .then(result => {
    console.log('üéâ –ù–∞—Å—Ç—Ä–æ–π–∫–∞ –∑–∞–≤–µ—Ä—à–µ–Ω–∞ —É—Å–ø–µ—à–Ω–æ:', result);
  })
  .catch(error => {
    console.error('‚ùå –ö—Ä–∏—Ç–∏—á–µ—Å–∫–∞—è –æ—à–∏–±–∫–∞:', error.message);
  });
```

---

## üìö –î–æ–ø–æ–ª–Ω–∏—Ç–µ–ª—å–Ω—ã–µ —Ä–µ—Å—É—Ä—Å—ã

- [–û—Ñ–∏—Ü–∏–∞–ª—å–Ω–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è Chatwoot API](https://www.chatwoot.com/docs/product/channels/api)
- [–ü—Ä–∏–º–µ—Ä—ã –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏–π](https://github.com/chatwoot/chatwoot/tree/develop/app/channels/api)
- [–°–æ–æ–±—â–µ—Å—Ç–≤–æ Chatwoot](https://community.chatwoot.com/)

---

## ü§ù –í–∫–ª–∞–¥ –≤ –ø—Ä–æ–µ–∫—Ç

–ï—Å–ª–∏ –≤—ã –Ω–∞—à–ª–∏ –æ—à–∏–±–∫—É –∏–ª–∏ —Ö–æ—Ç–∏—Ç–µ —É–ª—É—á—à–∏—Ç—å —ç—Ç–æ—Ç –≥–∞–π–¥, –ø–æ–∂–∞–ª—É–π—Å—Ç–∞:
1. –°–æ–∑–¥–∞–π—Ç–µ issue —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –ø—Ä–æ–±–ª–µ–º—ã
2. –û—Ç–ø—Ä–∞–≤—å—Ç–µ pull request —Å –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–∏—è–º–∏
3. –ü–æ–¥–µ–ª–∏—Ç–µ—Å—å —Å–≤–æ–∏–º –æ–ø—ã—Ç–æ–º –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è API

---

**–í–µ—Ä—Å–∏—è**: 1.0  
**–ü–æ—Å–ª–µ–¥–Ω–µ–µ –æ–±–Ω–æ–≤–ª–µ–Ω–∏–µ**: –î–µ–∫–∞–±—Ä—å 2023  
**–°–æ–≤–º–µ—Å—Ç–∏–º–æ—Å—Ç—å**: Chatwoot API v1